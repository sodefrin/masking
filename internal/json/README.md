copied and modified from go1.21 encoding json package
